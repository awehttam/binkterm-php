# Weather Report Generator

This script generates 5-day weather forecasts and current conditions for British Columbia and the Pacific Northwest region.

## Features

- **5-Day Forecast**: Detailed weather forecasts for major BC/PNW cities
- **Current Conditions**: Real-time weather data including temperature, humidity, wind, pressure
- **Netmail Format**: Prepares reports as netmail messages (without actually posting)
- **Multiple Locations**: Vancouver, Victoria, Seattle, Portland, Kelowna, Prince George

## Setup

### 1. Get OpenWeatherMap API Key

1. Sign up for a free account at [OpenWeatherMap](https://openweathermap.org/api)
2. Use the free tier which includes Current Weather API and 5-day Forecast API (1,000 free calls per day)
3. Get your API key from the dashboard

### 2. Configure API Key

Add your API key to the system configuration. You can either:

**Option A**: Add to your existing config file:
```php
'weather_api_key' => 'your_openweathermap_api_key_here'
```

**Option B**: Set as environment variable:
```bash
export WEATHER_API_KEY=your_openweathermap_api_key_here
```

## Usage

### Run the Script Directly

```bash
php scripts/weather_report.php
```

This will:
- Generate a weather report for all configured locations
- Show weather alerts if any are active
- Display the report structure without posting anything

### Use in Other Scripts

```php
require_once 'scripts/weather_report.php';

$generator = new WeatherReportGenerator();

// Generate text report
$report = $generator->generateReport();

// Create netmail message structure
$netmailData = $generator->createNetmailMessage('All', '1:153/757');
```

## Locations Covered

- **Vancouver, BC** - Major metro area
- **Victoria, BC** - Island weather
- **Seattle, WA** - Puget Sound region
- **Portland, OR** - Columbia River valley
- **Kelowna, BC** - Interior BC
- **Prince George, BC** - Northern BC

## Sample Output

```
PACIFIC NORTHWEST WEATHER REPORT
==================================================
Generated: Friday, September 6, 2025 at 14:30 PDT
Coverage: British Columbia & Pacific Northwest

CURRENT CONDITIONS
====================

Vancouver: 18°C (Light rain)
  Feels like 17°C, Humidity 78%, Wind 15.2 km/h
  Pressure 1013 hPa

Victoria: 16°C (Overcast)
  Feels like 15°C, Humidity 82%, Wind 12.8 km/h
  Pressure 1011 hPa

5-DAY FORECAST
====================

Vancouver:
----------
Fri Sep 6: Light rain, High 19°C, Low 13°C, Humidity 78%, Wind 15.3 km/h
Sat Sep 7: Overcast, High 17°C, Low 12°C, Humidity 85%, Wind 12.1 km/h
Sun Sep 8: Partly cloudy, High 21°C, Low 14°C, Humidity 72%, Wind 8.7 km/h
[... continues for 5 days]

Victoria:
---------
[... forecast data]

Weather data provided by OpenWeatherMap
Report generated by BinktermPHP v1.4.1
==================================================
```

## Configuration Options

The script automatically detects your system configuration. You can customize:

- API timeout (default: 10 seconds)
- Cities to include in the report
- Report format and styling
- Netmail sender information

## Error Handling

The script includes comprehensive error handling:
- Network timeouts
- API rate limiting
- Invalid API responses
- Missing configuration

If the weather API is unavailable, the script will generate an error message instead of failing silently.

## Automation

You can schedule this script to run automatically:

```bash
# Daily at 6 AM
0 6 * * * cd /path/to/binkterm-php && php scripts/weather_report.php
```

## API Limits

OpenWeatherMap's free tier includes:
- 1,000 API calls per day
- Current weather data
- 5-day weather forecast (3-hourly)

This script makes two API calls per location: one for current conditions, one for forecast (6 cities = 12 calls per report).